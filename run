#!/bin/bash

DC_COMMAND="docker-compose"

if ! command -v $DC_COMMAND &> /dev/null
then
    DC_COMMAND="docker compose"
fi

sudo docker stop soul-connection-db soul-connection-backend soul-connection-frontend
sudo docker rm soul-connection-db soul-connection-backend soul-connection-frontend

sudo docker network rm soul-connection
sudo docker network create --gateway 172.20.0.1 --subnet 172.20.0.0/24 soul-connection
sudo docker rmi epitech-soul-connection-backend epitech-soul-connection-frontend

./scripts/read_env.py > ./frontend/.env

sudo bash -c "export $(cat ./frontend/.env | xargs) && $DC_COMMAND up"

rm ./frontend/.env
